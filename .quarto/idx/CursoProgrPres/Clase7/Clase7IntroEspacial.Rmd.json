{"title":"Introducción a Sistemas de Información Geográfica","markdown":{"yaml":{"title":"Introducción a Sistemas de Información Geográfica","author":"Derek Corcoran","date":"`r format(Sys.time(), '%d/%m, %Y')`","output":{"ioslides_presentation":{"widescreen":true,"incremental":true}}},"headingText":"Que es el SIG","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = FALSE, tidy = TRUE, tidy.opts= list(blank = FALSE, width.cutoff = 60))\n  library(leaflet)\n  library(sf)\n  library(tidyverse)\n  library(rgdal)\n  library(raster)\n  library(rasterVis)\n  library(rworldxtra)\n  library(tidyverse)\n\nlibrary(gridExtra)\nlibrary(kableExtra)\noptions(\"kableExtra.html.bsTable\" = T)\n```\n\n\n## Sistema de Información Geográfica {.build}\n\n-   Representación de datos de forma espacial\n-   Muchos tipos de datos\n    -   Datos de captura remota (Satelites lidar)\n    -   Datos modelados (Modelos Distribución de Especies)\n    -   Datos de expertos\n    -   Planes futuros (Panificación territorial)\n    -   Mapas de fantasía (Tierra Media, Westeros)\n-   Dos formatos principales\n    -   Datos Vectoriales (Shapefiles)\n    -   Datos en grilla (Rasters)\n\n## Datos Vectoriales\n\n-   Shapefiles\n-   Puntos (Ciudades, presencias de especies, sucesos, sitios de muestreo)\n-   Lineas (Ríos, Carreteras, Caminos, Senderos)\n-   Polígonos (Países, Regiones, Lagos)\n-   Paquetes (sf, sp, raster)\n\n## Ejemplos datos vectoriales\n\n```{r, echo = TRUE}\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(rworldxtra)\ndata(\"countriesHigh\")\nMundo <- st_as_sf(countriesHigh)\n\nggplot() + geom_sf(data = Mundo, aes(fill = POP_EST))\n```\n\n## Ejemplos datos vectoriales (cont.)\n\n```{r, echo = TRUE}\nggplot() + geom_sf(data = Mundo, aes(fill = continent))\n```\n\n## Elegir parte de datos vectoriales\n\n```{r, echo = TRUE}\nAfrica <- Mundo %>% dplyr::filter(continent == \"Africa\")\nggplot() + geom_sf(data = Africa, aes(fill = POP_EST))\n```\n\n## Modificar datos vectoriales\n\n```{r, echo = T}\nAfrica <- Africa %>% mutate(Poblacion_mill = POP_EST/1000000)\nggplot() + geom_sf(data = Africa, aes(fill = Poblacion_mill)) + theme_bw() + scale_fill_viridis_c()\n```\n\n## Modificar datos vectoriales (Cont.)\n\n```{r, echo = T}\nAfrica <- Africa %>% mutate(PIB_per_Cap = GDP_MD_EST/POP_EST)\nggplot() + geom_sf(data = Africa, aes(fill = PIB_per_Cap)) + theme_bw()\n```\n\n## Exportar y leer datos vectoriales\n\n```{r, echo = T}\nAfrica <- Africa %>% dplyr::select(NAME, Poblacion_mill, PIB_per_Cap, GLOCAF)\nwrite_sf(Africa, \"Africa.shp\")\nAfrica2 <- read_sf(\"Africa.shp\")\nggplot() + geom_sf(data = Africa2, aes(fill = GLOCAF)) + theme_dark() \n```\n\n## Algunas bases de datos vectoriales\n\n-   [Datos vectoriales del mundo](http://www.diva-gis.org/gdata)\n-   [Datos vectoriales de Chile](https://www.bcn.cl/siit/mapas_vectoriales)\n\n## Algunas bases de datos vectoriales\n\n-   En raster función `getData(\"GADM\")`\n\n```{r, echo = T}\nPeru <- getData(name = \"GADM\", country = \"PER\", level = 1) %>% st_as_sf()\nggplot() + geom_sf(data = Peru) + theme(legend.position = \"none\")\n```\n\n# Raster\n\n## Datos en grilla\n\n-   Como una foto\n-   Cada pixel tiene ciertas caracteristicas (Resolución, Proyección, Unidades)\n\n```{r, echo = T}\nPrec <- getData(\"worldclim\", res = 10, var = \"prec\") \nPrec\n```\n\n## Precipitacion\n\n```{r, echo = T}\nplot(Prec)\n```\n\n## Subset de stacks\n\n```{r, echo =T}\nInvierno <- Prec[[c(6,7,8)]]\n\nplot(Invierno)\n```\n\n## Operaciones Simples\n\n```{r, echo = T}\nTotal_inv <- Prec[[1]] + Prec[[2]] + Prec[[3]]\nplot(Total_inv)\n```\n\n## O resumen total\n\n```{r, echo = T}\nPP_Total <- sum(Prec)\nplot(PP_Total)\n```\n\n## Cortar un raster (En base a otro mapa)\n\n```{r, echo = T, echo = T, echo = T}\nRaster_Africa <- PP_Total %>% crop(Africa)\nplot(Raster_Africa)\n```\n\n## Exportar y leer un raster\n\n```{r, echo = T}\nwriteRaster(Raster_Africa, \"PP_Africa.tif\", overwrite = T)\nAfricaRast2 <- raster(\"PP_Africa.tif\")\n```\n\n## Exportar y leer un raster\n\n```{r, echo = T}\nplot(AfricaRast2)\n```\n\n## Proyecciones y por que importan\n\n```{r}\nArea <- area(AfricaRast2) %>% mask(Africa)\nplot(Area)\n```\n\n## Proyecciones\n\n```{r, echo = T}\nproj4string(AfricaRast2)\n```\n\n-   Supongamos que el gráfico anterior fuera de diversidad\n    -   Tiene sentido comparar diversidad de especies en celdas de áreas diferentes?\n-   [Projection wizard](https://projectionwizard.org/)\n-   Además por presentación\n\n## Reproyectar a equal area\n\n```{r, echo=T}\nnewproj <- \"+proj=laea +lon_0=18.28125 +lat_0=0 +datum=WGS84 +units=km +no_defs\"\nAfrica_igual <- projectRaster(AfricaRast2, crs=newproj)\nplot(Africa_igual)\n```\n\n## La prueba\n\n```{r}\nArea <- area(Africa_igual) %>% mask(Africa_igual)\nplot(Area)\n```\n\n# Graficar juntos\n\n## Graficar rasters y shapefiles juntos\n\n```{r, echo = T}\nAfrica_DF <- AfricaRast2 %>% as(\"SpatialPixelsDataFrame\") %>% as.data.frame()\nAfrica_DF <- Africa_DF %>% rename(Prec = PP_Africa)\nggplot() + geom_tile(data = Africa_DF, aes(x = x, y = y, fill = Prec)) + geom_sf(data = Africa, alpha = 0) + theme_bw() + scale_fill_viridis_c()\n```\n\n## Graficar rasters y shapefiles juntos\n\n```{r, echo = T}\nggplot() + geom_tile(data = Africa_DF, aes(x = x, y = y, fill = Prec)) + geom_sf(data = Africa, alpha = 0)  + coord_sf(crs = \"+proj=laea +lon_0=18.28125 +lat_0=0 +datum=WGS84 +units=km +no_defs\")+ theme_bw() + scale_fill_viridis_c()\n```\n\n# Mas preguntas?\n\n```{r, echo = F, results='hide'}\nfile.remove(\"PP_Africa.tif\")\nfile.remove(\"Africa.dbf\")\nfile.remove(\"Africa.prj\")\nfile.remove(\"Africa.shp\")\nfile.remove(\"Africa.shx\")\nfile.remove(\"gadm36_PER_1_sp.rds\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":{"ioslides_presentation":{"widescreen":true,"incremental":true}},"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"Clase7IntroEspacial.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"cosmo","title":"Introducción a Sistemas de Información Geográfica","author":"Derek Corcoran","date":"`r format(Sys.time(), '%d/%m, %Y')`"},"extensions":{"book":{"multiFile":true}}}}}